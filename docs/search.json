[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Cuadernos de Estadística Espacial",
    "section": "",
    "text": "Introducción\nEn los siguientes cuadernos encontrará ejemplos con código sobre estadística espacial escalar y funcional. Para poder correr todos los ejemplos clone el repositorio de la siguiente forma. Debe tener instalado previamente git en su computador.\ngit clone --branch gh-pages  https://github.com/mpbohorquezc/SpatFD-Functional-Geostatistics.git\nSi esta corriendo sobre Ubuntu o Mint es importante tener algunos compiladores previamente instalados para poder instanciar algunas de las librerías. En general con los siguientes comandos podría correr cualquiera de los cuadernos sin problema\nsudo apt-get install r-base-dev\nsudo apt install liblapack-dev libopenblas-dev\nSi alguna dependencia hace falta algunos repositorios los puede descargar e instalar a manera de archivo .tar.gz o se encuentran simplemente en los repositorios del CRAN.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Introducción</span>"
    ]
  },
  {
    "objectID": "7.html",
    "href": "7.html",
    "title": "Geoestadística con sgeostat",
    "section": "",
    "text": "Geoestadística con sgeostat",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística con Sgeostat</span>"
    ]
  },
  {
    "objectID": "7.html#data-load",
    "href": "7.html#data-load",
    "title": "Geoestadística con sgeostat",
    "section": "Data Load",
    "text": "Data Load\n\nrm(list=ls())\naquifer=read.table(\"data/aquifer.txt\",head=T,dec=\",\")\nhead(aquifer)\n\n       Este     Norte Profundidad\n1  42.78275 127.62282        1464\n2 -27.39691  90.78732        2553\n3  -1.16289  84.89600        2158\n4 -18.61823  76.45199        2455\n5  96.46549  64.58058        1756\n6 108.56243  82.92325        1702",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística con Sgeostat</span>"
    ]
  },
  {
    "objectID": "7.html#libraries",
    "href": "7.html#libraries",
    "title": "Geoestadística con sgeostat",
    "section": "Libraries",
    "text": "Libraries\n\nlibrary(scatterplot3d)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(sgeostat)",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística con Sgeostat</span>"
    ]
  },
  {
    "objectID": "7.html#including-plots",
    "href": "7.html#including-plots",
    "title": "Geoestadística con sgeostat",
    "section": "Including Plots",
    "text": "Including Plots\n\ng1=ggplot(aquifer, aes(Profundidad, Este)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Este\") + \n  ylab(\"Profundidad\")\n\ng2=ggplot(aquifer, aes(Profundidad, Norte)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Norte\") + \n  ylab(\"Profundidad\")\n\ng3=ggplot(aquifer, aes(Profundidad, Este*Norte)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Interacción este,norte\") + \n  ylab(\"Profundidad\")\n\n\nplot_grid(g1,g2,g3)\n\n\n\n\n\n\n\n\n\ncor(aquifer)\n\n                  Este      Norte Profundidad\nEste         1.0000000  0.1147565  -0.7788885\nNorte        0.1147565  1.0000000  -0.6200923\nProfundidad -0.7788885 -0.6200923   1.0000000\n\n\n\nscatterplot3d(aquifer, highlight.3d=TRUE, col.axis=\"blue\",\ncol.grid=\"lightblue\", main=\"Tendencia de Profundidad\", pch=20)\n\n\n\n\n\n\n\n\n\nreg1 &lt;- lm(Profundidad ~ Este + Norte, data = aquifer)\nresiduales1  &lt;-  residuals(reg1)\nsummary(reg1)\n\n\nCall:\nlm(formula = Profundidad ~ Este + Norte, data = aquifer)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-366.96 -161.53  -30.71  148.15  651.20 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 2591.4302    38.9599   66.52   &lt;2e-16 ***\nEste          -6.7514     0.3438  -19.64   &lt;2e-16 ***\nNorte         -5.9872     0.4066  -14.73   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 203.3 on 82 degrees of freedom\nMultiple R-squared:  0.8921,    Adjusted R-squared:  0.8894 \nF-statistic: 338.9 on 2 and 82 DF,  p-value: &lt; 2.2e-16\n\n\n\nanova(reg1)\n\nAnalysis of Variance Table\n\nResponse: Profundidad\n          Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    \nEste       1 19045642 19045642  460.95 &lt; 2.2e-16 ***\nNorte      1  8960172  8960172  216.86 &lt; 2.2e-16 ***\nResiduals 82  3388069    41318                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nreg2 &lt;- lm(Profundidad ~ Este*Norte, data = aquifer)\nresiduales2  &lt;-  residuals(reg2)\nsummary(reg2)\n\n\nCall:\nlm(formula = Profundidad ~ Este * Norte, data = aquifer)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-406.30 -138.88  -13.04  129.36  722.48 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  2.627e+03  3.833e+01  68.546  &lt; 2e-16 ***\nEste        -8.287e+00  5.658e-01 -14.646  &lt; 2e-16 ***\nNorte       -6.649e+00  4.327e-01 -15.366  &lt; 2e-16 ***\nEste:Norte   2.452e-02  7.401e-03   3.314  0.00138 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 191.9 on 81 degrees of freedom\nMultiple R-squared:  0.905, Adjusted R-squared:  0.9014 \nF-statistic: 257.1 on 3 and 81 DF,  p-value: &lt; 2.2e-16\n\n\n\nanova(reg2)\n\nAnalysis of Variance Table\n\nResponse: Profundidad\n           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    \nEste        1 19045642 19045642  517.06 &lt; 2.2e-16 ***\nNorte       1  8960172  8960172  243.25 &lt; 2.2e-16 ***\nEste:Norte  1   404448   404448   10.98  0.001379 ** \nResiduals  81  2983621    36835                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nreg3 &lt;- lm(Profundidad ~ Este*Norte+I(Este^2)*I(Norte^2), data = aquifer)\nresiduales3  &lt;-  residuals(reg3)\nsummary(reg3)\n\n\nCall:\nlm(formula = Profundidad ~ Este * Norte + I(Este^2) * I(Norte^2), \n    data = aquifer)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-372.7 -133.6  -20.3  129.9  505.1 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           2.538e+03  7.038e+01  36.055   &lt;2e-16 ***\nEste                 -7.728e+00  6.028e-01 -12.822   &lt;2e-16 ***\nNorte                -3.075e+00  1.770e+00  -1.737   0.0863 .  \nI(Este^2)            -6.792e-03  5.967e-03  -1.138   0.2585    \nI(Norte^2)           -2.372e-02  9.049e-03  -2.622   0.0105 *  \nEste:Norte            1.155e-02  9.680e-03   1.193   0.2365    \nI(Este^2):I(Norte^2)  2.251e-06  9.541e-07   2.360   0.0208 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 180.7 on 78 degrees of freedom\nMultiple R-squared:  0.9189,    Adjusted R-squared:  0.9126 \nF-statistic: 147.2 on 6 and 78 DF,  p-value: &lt; 2.2e-16\n\n\n\nanova(reg3)\n\nAnalysis of Variance Table\n\nResponse: Profundidad\n                     Df   Sum Sq  Mean Sq  F value    Pr(&gt;F)    \nEste                  1 19045642 19045642 583.2335 &lt; 2.2e-16 ***\nNorte                 1  8960172  8960172 274.3868 &lt; 2.2e-16 ***\nI(Este^2)             1    55368    55368   1.6955 0.1967061    \nI(Norte^2)            1   152170   152170   4.6599 0.0339500 *  \nEste:Norte            1   451567   451567  13.8283 0.0003755 ***\nI(Este^2):I(Norte^2)  1   181854   181854   5.5689 0.0207829 *  \nResiduals            78  2547110    32655                       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\naquifer=data.frame(aquifer,resi=residuales2)\naquifer_points=point(aquifer, x=\"Este\", y=\"Norte\")\naquifer_pair=pair(aquifer_points,num.lags=10)\n\n....................................................................................\n\n\n\nstr(aquifer_pair)\n\nList of 5\n $ from: num [1:3570] 1 1 1 1 1 1 1 1 1 1 ...\n $ to  : num [1:3570] 2 3 4 5 6 7 8 9 10 11 ...\n $ lags: Factor w/ 10 levels \"1\",\"2\",\"3\",\"4\",..: 3 3 3 4 3 4 4 4 4 4 ...\n $ dist: num [1:3570] 79.3 61.3 79.9 82.8 79.5 ...\n $ bins: num [1:10] 13.6 40.7 67.8 94.9 122 ...\n - attr(*, \"type\")= chr \"isotropic\"\n - attr(*, \"class\")= chr \"pair\"\n\n\n\naquifer.v&lt;-est.variogram(aquifer_points,aquifer_pair,'resi')\n\n\ng4=ggplot(aquifer, aes(resi, Este)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Este\") + \n  ylab(\"residuales2\")\n\ng5=ggplot(aquifer, aes(resi, Norte)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Norte\") + \n  ylab(\"residuales2\")\n\nplot_grid(g4,g5)\n\n\n\n\n\n\n\n\n\naquifer_points=point(aquifer, x=\"Este\", y=\"Norte\")\nfit.trend(aquifer_points,at=\"Profundidad\", np=2, plot.it=TRUE)\n\n\n\n\n\n\n\n\n$beta\n      x^0 y^0       x^1 y^0       x^2 y^0       x^0 y^1       x^1 y^1 \n 2.481430e+03 -8.373708e+00  1.416675e-03 -2.043419e+00  2.680056e-02 \n      x^0 y^2 \n-2.464371e-02 \n\n$R\n       x^0 y^0   x^1 y^0    x^2 y^0    x^0 y^1    x^1 y^1   x^0 y^2\n[1,] -9.219544 -155.6739 -41051.636 -731.67314 -16082.944 -85540.31\n[2,]  0.000000  595.1832   3500.219   57.75539  38829.771  12491.66\n[3,]  0.000000    0.0000  39397.313 -117.36878   1909.315 -23722.80\n[4,]  0.000000    0.0000      0.000  485.98967  14332.040  91118.22\n[5,]  0.000000    0.0000      0.000    0.00000  25401.055   3240.90\n[6,]  0.000000    0.0000      0.000    0.00000      0.000  19989.20\n\n$np\n[1] 2\n\n$x\n [1]   42.78275  -27.39691   -1.16289  -18.61823   96.46549  108.56243\n [7]   88.36356   90.04213   93.17269   97.61099   90.62946   92.55262\n[13]   99.48996  -24.06744  -26.06285   56.27842   73.03881   80.26679\n[19]   80.23009   68.83845   76.39921   64.46148   43.39657   39.07769\n[25]  112.80450   54.25899    6.13202   -3.80469   -2.23054   -2.36177\n[31]   -2.18890   63.22428  -10.77860  -18.98889  -38.57884   83.14496\n[37]  -21.80248  -23.56457  -20.11299  -16.62654   29.90748  100.91568\n[43]  101.29544  103.26625  -14.31073  -18.13447  -18.12151   -9.88796\n[49]  -12.16336   11.65754   61.69122   69.57896   66.72205  -36.65446\n[55]  -19.55102  -21.29791  -22.36166   21.14719    7.68461   -8.33227\n[61]   56.70724   59.00052   68.96893   70.90225   73.00243   59.66237\n[67]   61.87249   63.70810    5.62706   18.24739   85.68824  105.07646\n[73] -101.64278 -145.23654  -73.99313  -94.48182  -88.84983 -120.25898\n[79]  -86.02454  -72.79097 -100.17372  -78.83539  -83.69063  -95.61661\n[85]  -87.55480\n\n$y\n [1] 127.62282  90.78732  84.89600  76.45199  64.58058  82.92325  56.45348\n [8]  39.25820  33.05852  56.27887  35.08169  41.75238  59.15785 184.76636\n[15] 114.07479  26.84826  18.88140  12.61593  14.61795 107.77423  95.99380\n[22] 110.39641  53.61499  61.99805  45.54766 147.81987  48.32772  40.40450\n[29]  29.91113  33.82002  33.68207  79.49924 175.11346 171.91695 158.52742\n[36] 159.11559  15.02551   9.41441  22.09269  17.25621 175.12875  22.97808\n[43]  22.96385  20.34239  31.26545  30.18118  29.53241  38.14483  39.11081\n[50]  18.73347  32.94906  33.80841  33.93264 150.91457 137.78404 131.82542\n[57] 137.13680 139.26199 126.83751 107.77691 171.26443 164.54863 177.24820\n[64] 161.38136 162.98959 170.10544 174.30177 173.91454  79.08730  77.39191\n[71] 139.81702 132.03181  10.65106  28.02333  87.97270  86.62606  76.70991\n[78]  80.76485  54.36334  43.09215  42.89881  40.82141  46.50482  35.82183\n[85]  29.39267\n\n$z\n [1] 1464 2553 2158 2455 1756 1702 1805 1797 1714 1466 1729 1638 1736 1476 2200\n[16] 1999 1680 1806 1682 1306 1722 1437 1828 2118 1725 1606 2648 2560 2544 2386\n[31] 2400 1757 1402 1364 1735 1376 2729 2766 2736 2432 1024 1611 1548 1591 2540\n[46] 2352 2528 2575 2468 2646 1739 1674 1868 1865 1777 1579 1771 1408 1527 2003\n[61] 1386 1089 1384 1030 1092 1161 1415 1231 2300 2238 1038 1332 3510 3490 2594\n[76] 2650 2533 3571 2811 2728 3136 2553 2798 2691 2946\n\n$residuals\n [1] -145.932017  296.391955   20.569629  155.586776  136.944207  210.578982\n [7]  112.643763   81.535500   12.407325 -165.733666   11.643984  -55.843867\n[13]  123.038140  130.250727  132.838620   16.473072 -186.973641   -9.864104\n[19] -133.020821 -298.072286   98.737035 -175.328351 -174.667016  118.113364\n[25]  176.632628  200.333264  366.232978  173.604750  128.842139  -15.778284\n[31]   -1.005758  -17.176812   -5.743382 -109.803640   35.578021  175.509274\n[37]  109.375693  113.827801  154.658230 -138.758151 -234.947039  -41.999962\n[43] -102.169175  -45.349545   38.415648 -182.959426   -9.456222  134.544149\n[49]   14.873572  303.070200 -191.631118 -197.446346  -23.989926   92.632496\n[55]  -47.092725 -308.538280  -72.511843 -213.402614 -260.643390  -17.741523\n[61]  187.380986 -159.999448  282.152142 -199.908135 -116.838018  -37.190026\n[67]  262.093246   81.109636  169.467368  176.796541 -289.932780   42.387375\n[73]  216.381585  -51.786437   30.159248  -53.946573 -219.188525  648.160187\n[79]  -92.004756 -152.583829   49.711612 -386.649271 -141.519561 -407.429504\n[85] -129.126052\n\nattr(,\"class\")\n[1] \"trend.surface\"\n\n\n\ng6=ggplot(aquifer.v, aes(resi, Norte)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Norte\") + \n  ylab(\"residuales2\")\n\ng6=ggplot(aquifer.v, aes(bins, classic)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Rezago espacial, h\") + \n  ylab(\"Estimador clásico del variograma\")\n\ng7=ggplot(aquifer.v, aes(bins, robust)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Rezago espacial, h\") + \n  ylab(\"Estimador robusto 1 del variograma\")\n\ng8=ggplot(aquifer.v, aes(bins, med)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Rezago espacial, h\") + \n  ylab(\"Estimador robusto 2 del variograma\")\n\nplot_grid(g6,g7,g8,nrow=1,ncol=3)\n\n\n\n\n\n\n\n\n\n#par(mfrow=c(1,3))\nprint(aquifer.v)\n\n   lags      bins   classic    robust       med   n\n1     1  13.55308  43779.20  44355.34  47948.45 285\n2     2  40.65923  71039.50  71176.29  73188.30 350\n3     3  67.76539  80041.91  85367.59  93223.52 492\n4     4  94.87154  67197.27  68067.40  73056.46 719\n5     5 121.97770  73572.25  68052.99  66133.91 612\n6     6 149.08385  57650.90  58608.95  58819.91 521\n7     7 176.19001  65498.82  62167.57  68112.31 356\n8     8 203.29616 130414.72 107613.55  77805.71 173\n9     9 230.40231 161738.13 134102.60 123952.77  43\n10   10 257.50847  35525.99  45217.14  58333.98  19\n\n\n\nplot(aquifer.v$robust)\n\n\n\n\n\n\n\n\n\nplot(aquifer.v$med,col='blue')\npoints(aquifer.v$robust,col=\"red\")\n\n\n\n\n\n\n\n\n\naquifer.vmodExp&lt;-fit.exponential(aquifer.v,c0=0,ce=40000,ae=20,plot.it=TRUE,iterations=30)\n\nInitial parameter estimates:  0 40000 20 \n\n\n\n\n\n\n\n\n\nIteration: 1 \nGradient vector:  -4432.441 977.0988 -8.943538 \nNew parameter estimates:  1e-06 40977.1 11.05646 \n\nrse.dif =  3232643827 (rse = 3232643827 )  ;  parm.dist =  977.1397 \n\n\n\n\n\n\n\n\n\nIteration: 2 \nGradient vector:  -26700.7 22493.46 -2.800242 \nNew parameter estimates:  1e-06 63470.56 8.256219 \n\nrse.dif =  -17644208 (rse = 3.215e+09 )  ;  parm.dist =  22493.46 \n\n\n\n\n\n\n\n\n\nIteration: 3 \nGradient vector:  -11057.27 -15597.73 2.315183 \nNew parameter estimates:  1e-06 47872.83 10.5714 \n\nrse.dif =  -3772568 (rse = 3211227051 )  ;  parm.dist =  15597.73 \n\n\n\n\n\n\n\n\n\nIteration: 4 \nGradient vector:  -27525.12 16431.58 -1.824505 \nNew parameter estimates:  1e-06 64304.41 8.746897 \n\nrse.dif =  3032851 (rse = 3214259902 )  ;  parm.dist =  16431.58 \n\n\n\n\n\n\n\n\n\nIteration: 5 \nGradient vector:  -20442.22 -7053.019 1.144197 \nNew parameter estimates:  1e-06 57251.39 9.891094 \n\nrse.dif =  -2468665 (rse = 3211791237 )  ;  parm.dist =  7053.019 \n\n\n\n\n\n\n\n\n\nIteration: 6 \nGradient vector:  -27557.41 7097.539 -0.7122805 \nNew parameter estimates:  1e-06 64348.93 9.178813 \n\nrse.dif =  1486180 (rse = 3213277417 )  ;  parm.dist =  7097.539 \n\n\n\n\n\n\n\n\n\nIteration: 7 \nGradient vector:  -24787.06 -2758.919 0.3605893 \nNew parameter estimates:  1e-06 61590.01 9.539403 \n\nrse.dif =  -951749.7 (rse = 3212325667 )  ;  parm.dist =  2758.919 \n\n\n\n\n\n\n\n\n\nIteration: 8 \nGradient vector:  -26691.4 1898.737 -0.1885371 \nNew parameter estimates:  1e-06 63488.75 9.350866 \n\nrse.dif =  471370.4 (rse = 3212797038 )  ;  parm.dist =  1898.737 \n\n\n\n\n\n\n\n\n\nIteration: 9 \nGradient vector:  -25850.35 -838.0686 0.09276125 \nNew parameter estimates:  1e-06 62650.68 9.443627 \n\nrse.dif =  -249219.6 (rse = 3212547818 )  ;  parm.dist =  838.0686 \n\n\n\n\n\n\n\n\n\nIteration: 10 \nGradient vector:  -26302.53 450.7265 -0.04631475 \nNew parameter estimates:  1e-06 63101.41 9.397312 \n\nrse.dif =  121873.4 (rse = 3212669692 )  ;  parm.dist =  450.7265 \n\n\n\n\n\n\n\n\n\nIteration: 11 \nGradient vector:  -26086.54 -215.2624 0.02285916 \nNew parameter estimates:  1e-06 62886.14 9.420171 \n\nrse.dif =  -61031.79 (rse = 3212608660 )  ;  parm.dist =  215.2624 \n\n\n\n\n\n\n\n\n\nIteration: 12 \nGradient vector:  -26195.52 108.6221 -0.01133309 \nNew parameter estimates:  1e-06 62994.77 9.408838 \n\nrse.dif =  30077.83 (rse = 3212638738 )  ;  parm.dist =  108.6221 \n\n\n\n\n\n\n\n\n\nIteration: 13 \nGradient vector:  -26142.08 -53.26613 0.005604603 \nNew parameter estimates:  1e-06 62941.5 9.414443 \n\nrse.dif =  -14922.96 (rse = 3212623815 )  ;  parm.dist =  53.26613 \n\n\n\n\n\n\n\n\n\nIteration: 14 \nGradient vector:  -26168.65 26.48517 -0.002774911 \nNew parameter estimates:  1e-06 62967.99 9.411668 \n\nrse.dif =  7377.216 (rse = 3212631192 )  ;  parm.dist =  26.48517 \n\n\n\n\n\n\n\n\n\nIteration: 15 \nGradient vector:  -26155.53 -13.07801 0.001373075 \nNew parameter estimates:  1e-06 62954.91 9.413041 \n\nrse.dif =  -3653.216 (rse = 3212627539 )  ;  parm.dist =  13.07801 \n\n\n\n\n\n\n\n\n\nIteration: 16 \nGradient vector:  -26162.03 6.479831 -0.0006796194 \nNew parameter estimates:  1e-06 62961.39 9.412361 \n\nrse.dif =  1807.514 (rse = 3212629346 )  ;  parm.dist =  6.479831 \n\n\n\n\n\n\n\n\n\nIteration: 17 \nGradient vector:  -26158.82 -3.20516 0.0003363367 \nNew parameter estimates:  1e-06 62958.18 9.412698 \n\nrse.dif =  -894.6895 (rse = 3212628451 )  ;  parm.dist =  3.20516 \n\n\n\n\n\n\n\n\n\nIteration: 18 \nGradient vector:  -26160.41 1.586717 -0.0001664615 \nNew parameter estimates:  1e-06 62959.77 9.412531 \n\nrse.dif =  442.763 (rse = 3212628894 )  ;  parm.dist =  1.586717 \n\n\n\n\n\n\n\n\n\nIteration: 19 \nGradient vector:  -26159.62 -0.7851797 8.238305e-05 \nNew parameter estimates:  1e-06 62958.98 9.412613 \n\nrse.dif =  -219.1369 (rse = 3212628675 )  ;  parm.dist =  0.7851797 \n\n\n\n\n\n\n\n\n\nIteration: 20 \nGradient vector:  -26160.01 0.3886224 -4.077271e-05 \nNew parameter estimates:  1e-06 62959.37 9.412573 \n\nrse.dif =  108.4519 (rse = 3212628784 )  ;  parm.dist =  0.3886224 \n\n\n\n\n\n\n\n\n\nIteration: 21 \nGradient vector:  -26159.82 -0.192328 2.01789e-05 \nNew parameter estimates:  1e-06 62959.18 9.412593 \n\nrse.dif =  -53.67477 (rse = 3212628730 )  ;  parm.dist =  0.192328 \n\n\n\n\n\n\n\n\n\nIteration: 22 \nGradient vector:  -26159.91 0.09518727 -9.986825e-06 \nNew parameter estimates:  1e-06 62959.28 9.412583 \n\nrse.dif =  26.56425 (rse = 3212628756 )  ;  parm.dist =  0.09518727 \n\n\n\n\n\n\n\n\n\nIteration: 23 \nGradient vector:  -26159.86 -0.04710907 4.94261e-06 \nNew parameter estimates:  1e-06 62959.23 9.412588 \n\nrse.dif =  -13.14703 (rse = 3212628743 )  ;  parm.dist =  0.04710907 \n\n\n\n\n\n\n\n\n\nIteration: 24 \nGradient vector:  -26159.89 0.023315 -2.446165e-06 \nNew parameter estimates:  1e-06 62959.25 9.412585 \n\nrse.dif =  6.506634 (rse = 3212628750 )  ;  parm.dist =  0.023315 \n\n\n\n\n\n\n\n\n\nIteration: 25 \nGradient vector:  -26159.88 -0.01153889 1.21064e-06 \nNew parameter estimates:  1e-06 62959.24 9.412587 \n\nrse.dif =  -3.220222 (rse = 3212628747 )  ;  parm.dist =  0.01153889 \n\n\n\n\n\n\n\n\n\nIteration: 26 \nGradient vector:  -26159.88 0.005710764 -5.991627e-07 \nNew parameter estimates:  1e-06 62959.25 9.412586 \n\nrse.dif =  1.593734 (rse = 3212628748 )  ;  parm.dist =  0.005710764 \n\n\n\n\n\n\n\n\n\nIteration: 27 \nGradient vector:  -26159.88 -0.002826342 2.965346e-07 \nNew parameter estimates:  1e-06 62959.24 9.412586 \n\nrse.dif =  -0.7887611 (rse = 3212628747 )  ;  parm.dist =  0.002826342 \n\n\n\n\n\n\n\n\n\nIteration: 28 \nGradient vector:  -26159.88 0.001398795 -1.467591e-07 \nNew parameter estimates:  1e-06 62959.24 9.412586 \n\nrse.dif =  0.3903689 (rse = 3212628748 )  ;  parm.dist =  0.001398795 \n\n\n\n\n\n\n\n\n\nIteration: 29 \nGradient vector:  -26159.88 -0.0006922812 7.263288e-08 \nNew parameter estimates:  1e-06 62959.24 9.412586 \n\nrse.dif =  -0.1932006 (rse = 3212628748 )  ;  parm.dist =  0.0006922812 \n\n\n\n\n\n\n\n\n\nIteration: 30 \nGradient vector:  -26159.88 0.000342624 -3.594748e-08 \nNew parameter estimates:  1e-06 62959.24 9.412586 \n\nrse.dif =  0.09561825 (rse = 3212628748 )  ;  parm.dist =  0.000342624 \n\n\n\n\n\n\n\n\n\nConvergence not achieved!\n\n\n\naquifer.vmodGau&lt;-fit.gaussian(aquifer.v,c0=0,cg=50000,ag=50,plot.it=TRUE,iterations=30)\n\nInitial parameter estimates:  0 50000 50 \n\n\n\n\n\n\n\n\n\nIteration: 1 \nGradient vector:  19162.34 -33401.14 -11.41191 \nNew parameter estimates:  19162.34 16598.86 38.58809 \n\nrse.dif =  3299750048 (rse = 3299750048 )  ;  parm.dist =  38507.55 \n\n\n\n\n\n\n\n\n\nIteration: 2 \nGradient vector:  -1294.927 2010.017 -18.77473 \nNew parameter estimates:  17867.41 18608.87 19.81336 \n\nrse.dif =  -66430135 (rse = 3233319913 )  ;  parm.dist =  2391.1 \n\n\n\n\n\n\n\n\n\nIteration: 3 \nGradient vector:  3201.043 -2835.169 9.216254 \nNew parameter estimates:  21068.46 15773.71 29.02961 \n\nrse.dif =  -24694350 (rse = 3208625564 )  ;  parm.dist =  4276.09 \n\n\n\n\n\n\n\n\n\nIteration: 4 \nGradient vector:  -4345.272 4292.413 -6.361973 \nNew parameter estimates:  16723.18 20066.12 22.66764 \n\nrse.dif =  4004881 (rse = 3212630445 )  ;  parm.dist =  6107.884 \n\n\n\n\n\n\n\n\n\nIteration: 5 \nGradient vector:  53.88685 -4.270081 2.074271 \nNew parameter estimates:  16777.07 20061.85 24.74191 \n\nrse.dif =  -3703977 (rse = 3208926468 )  ;  parm.dist =  54.09555 \n\n\n\n\n\n\n\n\n\nIteration: 6 \nGradient vector:  -391.4471 384.4526 -0.5571294 \nNew parameter estimates:  16385.62 20446.3 24.18478 \n\nrse.dif =  588163 (rse = 3209514631 )  ;  parm.dist =  548.6666 \n\n\n\n\n\n\n\n\n\nIteration: 7 \nGradient vector:  29.55911 -27.0943 0.07968918 \nNew parameter estimates:  16415.18 20419.21 24.26447 \n\nrse.dif =  -201438.9 (rse = 3209313192 )  ;  parm.dist =  40.09799 \n\n\n\n\n\n\n\n\n\nIteration: 8 \nGradient vector:  -6.581211 6.259206 -0.01207028 \nNew parameter estimates:  16408.6 20425.47 24.2524 \n\nrse.dif =  26607.8 (rse = 3209339800 )  ;  parm.dist =  9.082408 \n\n\n\n\n\n\n\n\n\nIteration: 9 \nGradient vector:  0.9423146 -0.8928955 0.001794561 \nNew parameter estimates:  16409.54 20424.57 24.25419 \n\nrse.dif =  -4077.43 (rse = 3209335722 )  ;  parm.dist =  1.298161 \n\n\n\n\n\n\n\n\n\nIteration: 10 \nGradient vector:  -0.1413215 0.1339887 -0.0002673761 \nNew parameter estimates:  16409.4 20424.71 24.25393 \n\nrse.dif =  605.1536 (rse = 3209336327 )  ;  parm.dist =  0.194743 \n\n\n\n\n\n\n\n\n\nIteration: 11 \nGradient vector:  0.02102884 -0.01993597 3.982407e-05 \nNew parameter estimates:  16409.42 20424.69 24.25397 \n\nrse.dif =  -90.18701 (rse = 3209336237 )  ;  parm.dist =  0.02897682 \n\n\n\n\n\n\n\n\n\nIteration: 12 \nGradient vector:  -0.003132718 0.00296995 -5.931842e-06 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  13.43229 (rse = 3209336251 )  ;  parm.dist =  0.004316777 \n\n\n\n\n\n\n\n\n\nIteration: 13 \nGradient vector:  0.0004666088 -0.0004423641 8.835486e-07 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  -2.000767 (rse = 3209336249 )  ;  parm.dist =  0.0006429701 \n\n\n\n\n\n\n\n\n\nIteration: 14 \nGradient vector:  -6.950171e-05 6.589045e-05 -1.316048e-07 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  0.2980142 (rse = 3209336249 )  ;  parm.dist =  9.577086e-05 \n\n\n\n\n\n\n\n\n\nIteration: 15 \nGradient vector:  1.035229e-05 -9.814388e-06 1.960254e-08 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  -0.04438925 (rse = 3209336249 )  ;  parm.dist =  1.426508e-05 \n\n\n\n\n\n\n\n\n\nIteration: 16 \nGradient vector:  -1.542e-06 1.46188e-06 -2.919839e-09 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  0.006612301 (rse = 3209336249 )  ;  parm.dist =  2.124821e-06 \n\n\n\n\n\n\n\n\n\nIteration: 17 \nGradient vector:  2.296994e-07 -2.177628e-07 4.349363e-10 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  -0.0009851456 (rse = 3209336249 )  ;  parm.dist =  3.165152e-07 \n\n\n\n\n\n\n\n\n\nIteration: 18 \nGradient vector:  -3.420782e-08 3.242781e-08 -6.477718e-11 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  0.0001473427 (rse = 3209336249 )  ;  parm.dist =  4.713621e-08 \n\n\n\n\n\n\n\n\n\nIteration: 19 \nGradient vector:  5.086605e-09 -4.821087e-09 9.637383e-12 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  -2.193451e-05 (rse = 3209336249 )  ;  parm.dist =  7.007276e-09 \n\n\n\n\n\n\n\n\n\nIteration: 20 \nGradient vector:  -7.583935e-10 7.161523e-10 -1.439258e-12 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  2.861023e-06 (rse = 3209336249 )  ;  parm.dist =  1.042223e-09 \n\n\n\n\n\n\n\n\n\nIteration: 21 \nGradient vector:  1.019258e-10 -9.775917e-11 1.99309e-13 \nNew parameter estimates:  16409.42 20424.69 24.25396 \n\nrse.dif =  -4.768372e-07 (rse = 3209336249 )  ;  parm.dist =  1.415077e-10 \n\nConvergence achieved by sums of squares.\n\n\n\n\n\n\n\n\n\nFinal parameter estimates:  16409.42 20424.69 24.25396 \n\n\n\naquifer.vmodWave&lt;-fit.wave(aquifer.v,c0=0,cw=40000,aw=10,plot.it=TRUE,iterations=30,weighted=T)\n\nInitial parameter estimates:  0 40000 10 \n\n\n\n\n\n\n\n\n\nIteration: 1 \nGradient vector:  18650.32 -21981.27 -0.7942028 \nNew parameter estimates:  18650.32 18018.73 9.205797 \n\nrse.dif =  3409704989 (rse = 3409704989 )  ;  parm.dist =  28827.26 \n\n\n\n\n\n\n\n\n\nIteration: 2 \nGradient vector:  812.9227 -1109.399 -1.187299 \nNew parameter estimates:  19463.25 16909.33 8.018498 \n\nrse.dif =  -289093760 (rse = 3120611230 )  ;  parm.dist =  1375.358 \n\n\n\n\n\n\n\n\n\nIteration: 3 \nGradient vector:  -6990.158 6973.566 0.9858099 \nNew parameter estimates:  12473.09 23882.9 9.004308 \n\nrse.dif =  24044562 (rse = 3144655792 )  ;  parm.dist =  9873.851 \n\n\n\n\n\n\n\n\n\nIteration: 4 \nGradient vector:  7025.438 -6960.473 -1.260353 \nNew parameter estimates:  19498.53 16922.43 7.743955 \n\nrse.dif =  -56767551 (rse = 3087888241 )  ;  parm.dist =  9889.639 \n\n\n\n\n\n\n\n\n\nIteration: 5 \nGradient vector:  -9210.154 9213.61 1.066674 \nNew parameter estimates:  10288.37 26136.04 8.810629 \n\nrse.dif =  175986924 (rse = 3263875165 )  ;  parm.dist =  13027.57 \n\n\n\n\n\n\n\n\n\nIteration: 6 \nGradient vector:  11994.7 -11983.26 -2.255679 \nNew parameter estimates:  22283.07 14152.77 6.55495 \n\nrse.dif =  -196728543 (rse = 3067146622 )  ;  parm.dist =  16954.98 \n\n\n\n\n\n\n\n\n\nIteration: 7 \nGradient vector:  -14060.45 14195.04 -1.578095 \nNew parameter estimates:  8222.625 28347.81 4.976855 \n\nrse.dif =  147278852 (rse = 3214425474 )  ;  parm.dist =  19979.87 \n\n\n\n\n\n\n\n\n\nIteration: 8 \nGradient vector:  -15826.64 16212.91 0.3854677 \nNew parameter estimates:  1e-06 44560.72 5.362323 \n\nrse.dif =  -46983778 (rse = 3167441696 )  ;  parm.dist =  18178.84 \n\n\n\n\n\n\n\n\n\nIteration: 9 \nGradient vector:  13145.08 -21444.98 -0.8756698 \nNew parameter estimates:  13145.08 23115.75 4.486653 \n\nrse.dif =  -757940879 (rse = 2409500817 )  ;  parm.dist =  25153.13 \n\n\n\n\n\n\n\n\n\nIteration: 10 \nGradient vector:  -9434763 9682459 25.73116 \nNew parameter estimates:  1e-06 9705575 30.21781 \n\nrse.dif =  1636307005 (rse = 4045807822 )  ;  parm.dist =  9682468 \n\n\n\n\n\n\n\n\n\nIteration: 11 \nGradient vector:  20962.2 -9688482 0.02156687 \nNew parameter estimates:  20962.2 17093.21 30.23938 \n\nrse.dif =  83628062 (rse = 4129435883 )  ;  parm.dist =  9688504 \n\n\n\n\n\n\n\n\n\nIteration: 12 \nGradient vector:  7173.136 -8587.116 1.22582 \nNew parameter estimates:  28135.34 8506.099 31.4652 \n\nrse.dif =  -628497356 (rse = 3500938527 )  ;  parm.dist =  11188.94 \n\n\n\n\n\n\n\n\n\nIteration: 13 \nGradient vector:  2974.651 -2890.861 -4.19572 \nNew parameter estimates:  31109.99 5615.237 27.26947 \n\nrse.dif =  -192443200 (rse = 3308495327 )  ;  parm.dist =  4147.969 \n\n\n\n\n\n\n\n\n\nIteration: 14 \nGradient vector:  -2399.351 1443.698 15.69929 \nNew parameter estimates:  28710.64 7058.936 42.96876 \n\nrse.dif =  147479203 (rse = 3455974530 )  ;  parm.dist =  2800.25 \n\n\n\n\n\n\n\n\n\nIteration: 15 \nGradient vector:  4786.661 2165.107 -43.14322 \nNew parameter estimates:  33497.3 9224.042 1e-06 \n\nrse.dif =  -686128323 (rse = 2769846206 )  ;  parm.dist =  5253.728 \n\n\nIteration: 16 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  -7188.309 -5.926894e-07 0 \nNew parameter estimates:  26308.99 9224.042 1e-06 \n\nrse.dif =  686457465 (rse = 3456303671 )  ;  parm.dist =  7188.309 \n\n\nIteration: 17 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  -5.339328e-06 -5.926894e-07 0 \nNew parameter estimates:  26308.99 9224.042 1e-06 \n\nrse.dif =  0.4889331 (rse = 3456303672 )  ;  parm.dist =  5.372122e-06 \n\n\nIteration: 18 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  5.926852e-07 -5.926894e-07 0 \nNew parameter estimates:  26308.99 9224.042 1e-06 \n\nrse.dif =  1.907349e-06 (rse = 3456303672 )  ;  parm.dist =  8.381857e-07 \n\n\nIteration: 19 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  5.926931e-07 -5.926894e-07 0 \nNew parameter estimates:  26308.99 9224.042 1e-06 \n\nrse.dif =  -9.536743e-07 (rse = 3456303672 )  ;  parm.dist =  8.381908e-07 \n\nConvergence achieved by sums of squares.\n\n\n\n\n\n\n\n\n\nFinal parameter estimates:  26308.99 9224.042 1e-06 \n\n\n\ncurve(65000*(1-(14/x)*sin(x/14)),0,300,ylim=c(0,200000))\npoints(aquifer.v$bins,aquifer.v$classic,col=3)\ntext(aquifer.v$bins,aquifer.v$classic,aquifer.v$n,col=2)\n\n\n\n\n\n\n\n\n\ncurve(200000*(1-exp(-x/170)),0,300)\npoints(aquifer.v$bins,aquifer.v$classic,col=2)\n\n\n\n\n\n\n\n\n\ncurve(65000*(1-(14/x)*sin(x/14)),0,300,ylim=c(0,200000))\npoints(aquifer.v$bins,aquifer.v$classic,col=3)\ntext(aquifer.v$bins,aquifer.v$classic,aquifer.v$n,col=2)\n\n\n\n\n\n\n\n\n\naquifer.vmodExp&lt;-fit.exponential(aquifer.v,c0=0,ce=200000,ae=170,plot.it=TRUE,iterations=30,weighted=T)\n\nInitial parameter estimates:  0 2e+05 170 \n\n\n\n\n\n\n\n\n\nIteration: 1 \nGradient vector:  16365.66 -238859.4 -103.7436 \nNew parameter estimates:  16365.66 1e-06 66.25643 \n\nrse.dif =  3826411368 (rse = 3826411368 )  ;  parm.dist =  200668.5 \n\n\n\n\n\n\n\n\n\nIteration: 2 \nGradient vector:  7737.246 16547.95 166070861252 \nNew parameter estimates:  24102.91 16547.95 166070861318 \n\nrse.dif =  -767474321 (rse = 3058937047 )  ;  parm.dist =  166070861252 \n\n\nIteration: 3 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  3355.03 1.242479e+13 0 \nNew parameter estimates:  27457.94 1.242479e+13 166070861318 \n\nrse.dif =  -120011141 (rse = 2938925906 )  ;  parm.dist =  1.242479e+13 \n\n\nIteration: 4 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  423.3165 -663474885968 0 \nNew parameter estimates:  27881.25 1.176131e+13 166070861318 \n\nrse.dif =  11801483 (rse = 2950727388 )  ;  parm.dist =  663474885968 \n\n\nIteration: 5 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  3.873181 -6320523090 0 \nNew parameter estimates:  27885.12 1.175499e+13 166070861318 \n\nrse.dif =  128956.4 (rse = 2950856345 )  ;  parm.dist =  6320523090 \n\n\nIteration: 6 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  0.02266712 -36921321 0 \nNew parameter estimates:  27885.15 1.175495e+13 166070861318 \n\nrse.dif =  752.3639 (rse = 2950857097 )  ;  parm.dist =  36921321 \n\n\nIteration: 7 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  0.0001316946 -214507.3 0 \nNew parameter estimates:  27885.15 1.175495e+13 166070861318 \n\nrse.dif =  4.371067 (rse = 2950857102 )  ;  parm.dist =  214507.3 \n\n\nIteration: 8 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  7.650992e-07 -1246.212 0 \nNew parameter estimates:  27885.15 1.175495e+13 166070861318 \n\nrse.dif =  0.02539396 (rse = 2950857102 )  ;  parm.dist =  1246.213 \n\n\nIteration: 9 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  4.447233e-09 -7.24441 0 \nNew parameter estimates:  27885.15 1.175495e+13 166070861318 \n\nrse.dif =  0.0001473427 (rse = 2950857102 )  ;  parm.dist =  7.244141 \n\n\nIteration: 10 \n\n\nWarning in lsfit(xmat, y, wt = w, intercept = FALSE): 'X' matrix was collinear\n\n\n\n\n\n\n\n\n\nGradient vector:  2.31966e-11 -0.03646515 0 \nNew parameter estimates:  27885.15 1.175495e+13 166070861318 \n\nrse.dif =  9.536743e-07 (rse = 2950857102 )  ;  parm.dist =  0.03710938 \n\nConvergence achieved by sums of squares.\n\n\n\n\n\n\n\n\n\nFinal parameter estimates:  27885.15 1.175495e+13 166070861318 \n\n\n\naquifer.vmodwave&lt;-fit.wave(aquifer.v,c0=4000,cw=30000,aw=15,plot.it=TRUE,iterations=0,weighted=T)\n\n\n\n\n\n\n\n\nConvergence not achieved!\n\n\n\naquifer.vmodExp_0&lt;-fit.exponential(aquifer.v,c0=0,ce=200000,ae=170,plot.it=TRUE,iterations=0,weighted=T)\n\n\n\n\n\n\n\n\nConvergence not achieved!\n\n\n\naquifer.vmodwave_0&lt;-fit.wave(aquifer.v,c0=4000,cw=30000,aw=15,plot.it=TRUE,iterations=0,weighted=T)\n\n\n\n\n\n\n\n\nConvergence not achieved!\n\n\n\naquifer.spherical&lt;-fit.spherical(aquifer.v,c0=0,cs=35000,as=70,plot.it=TRUE,iterations=0,weighted=T)\n\n\n\n\n\n\n\n\nConvergence not achieved!\n\n\n\nggplot(aquifer.v, aes(bins, classic)) + \n  geom_point() + \n  geom_line() +\n  xlab(\"Rezago espacial, h\") + \n  ylab(\"Estimador clásico del variograma\")+\n  xlim(0, 300) +\n  geom_function(aes(color = \"Exponencial\"),\n    fun =~4000+150000*(1-exp(-.x/100)) \n    ) +\n  geom_function(aes(color = \"Seno cardinal\"),\n    fun =~4000+30000*(1-((15/.x)*sin(.x/15)))             \n    ) + xlab(\"Rezago espacial\") + ylab(\"Modelos teóricos de  semivariogramas\") \n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_function()`).\n\n\n\n\n\n\n\n\n\n\nKriging_aquifer &lt;- point(data.frame(list(x=10,y=80)))\nKriging_aquifer &lt;- krige(Kriging_aquifer, aquifer_points, 'resi', aquifer.vmodExp_0)\n\n\nUsing all points.\n  Preparing the kriging system matrix...\n  Inverting the matrix...\n  Predicting.\n\n\n\nKriging_aquifer\n\n\nPoint object: x \n\n   Locations: 1\n\n   Attributes:\n      x\n      y\n      do\n      zhat\n      sigma2hat\n\n\n\nKriging_aquifer$sigma2hat\n\n[1] 7010.452\n\n\n\nKriging_aquifer &lt;- point(data.frame(list(x=10,y=80)))\nKriging_aquifer &lt;- krige(Kriging_aquifer, aquifer_points, 'resi', aquifer.vmodwave_0)\n\n\nUsing all points.\n  Preparing the kriging system matrix...\n  Inverting the matrix...\n  Predicting.\n\n\n\nKriging_aquifer\n\n\nPoint object: x \n\n   Locations: 1\n\n   Attributes:\n      x\n      y\n      do\n      zhat\n      sigma2hat\n\n\n\nKriging_aquifer$zhat\n\n[1] 196.2781\n\n\n\nKriging_aquifer$sigma2hat\n\n[1] 5169.927\n\n\n\ngrid &lt;- list(x=seq(min(aquifer$Este),max(aquifer$Este),by=20),y=seq(min(aquifer$Norte),max(aquifer$Norte),by=10))\ngrid$xr &lt;- range(grid$x)\ngrid$xs &lt;- grid$xr[2] - grid$xr[1]\ngrid$yr &lt;- range(grid$y)\ngrid$ys &lt;- grid$yr[2] - grid$yr[1]\ngrid$max &lt;- max(grid$xs, grid$ys)\ngrid$xy &lt;- data.frame(cbind(c(matrix(grid$x, length(grid$x), length(grid$y))),\nc(matrix(grid$y, length(grid$x), length(grid$y), byrow=TRUE))))\ncolnames(grid$xy) &lt;- c(\"x\", \"y\")\ngrid$point &lt;- point(grid$xy)\ngrid$krige &lt;- krige(grid$point,aquifer_points,'resi',aquifer.vmodwave_0,maxdist=180,extrap=FALSE)\n\n\nUsing points within 180 units of prediction points.\n  Predicting..........................................................................................................................................................................................................................................\n\n\n\nop &lt;- par(no.readonly = TRUE)\npar(pty=\"s\")\nplot(grid$xy, type=\"n\", xlim=c(grid$xr[1], grid$xr[1]+grid$max),ylim=c(grid$yr[1], grid$yr[1]+grid$max))\nimage(grid$x,grid$y,matrix(grid$krige$zhat,length(grid$x),length(grid$y)),add=TRUE)\ncontour(grid$x,grid$y,matrix(grid$krige$zhat,length(grid$x),length(grid$y)),add=TRUE)\n\n\n\n\n\n\n\n\n\nx11()\nop &lt;- par(no.readonly = TRUE)\npar(pty=\"s\")\nplot(grid$xy, type=\"n\", xlim=c(grid$xr[1], grid$xr[1]+grid$max),ylim=c(grid$yr[1], grid$yr[1]+grid$max))\nimage(grid$x,grid$y,matrix(grid$krige$sigma2hat,length(grid$x),length(grid$y)), add=TRUE)\ncontour(grid$x,grid$y,matrix(grid$krige$sigma2hat,length(grid$x),length(grid$y)),add=TRUE)",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística con Sgeostat</span>"
    ]
  },
  {
    "objectID": "8.html",
    "href": "8.html",
    "title": "Geoestadística Univariada con geoR",
    "section": "",
    "text": "Geoestadística Univariada con geoR",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "8.html#parte-descriptiva",
    "href": "8.html#parte-descriptiva",
    "title": "Geoestadística Univariada con geoR",
    "section": "Parte descriptiva",
    "text": "Parte descriptiva\n\nLibrerías\nLista de librerías con link a la documentación.\n\nfields\ngeoR\nakima Usado para gráficos descriptivos\n\n\nrm(list=ls())\nlibrary(fields)\n\n\nlibrary(geoR)\n\n\nlibrary(akima)\n\n\n\nLectura de datos\n\naquifer &lt;- read.table(\"data/aquifer.txt\", head = TRUE, dec = \",\")\n\nEncabezado de datos aquifer.txt\n\nhead(aquifer)\n\n       Este     Norte Profundidad\n1  42.78275 127.62282        1464\n2 -27.39691  90.78732        2553\n3  -1.16289  84.89600        2158\n4 -18.61823  76.45199        2455\n5  96.46549  64.58058        1756\n6 108.56243  82.92325        1702\n\n\nSummary de los datos aquifer.txt",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "8.html#geo_data",
    "href": "8.html#geo_data",
    "title": "Geoestadística Univariada con geoR",
    "section": "GEO_Data",
    "text": "GEO_Data\n\nConvertir aquifer a un objeto geodata (GeoR obj)\n\nDocumentación as.geodata\n\naquiferg &lt;- as.geodata(aquifer)\nsummary(aquiferg)\n\nNumber of data points: 85 \n\nCoordinates summary\n         Este     Norte\nmin -145.2365   9.41441\nmax  112.8045 184.76636\n\nDistance summary\n        min         max \n  0.2211656 271.0615463 \n\nData summary\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n1024.000 1548.000 1797.000 2002.282 2540.000 3571.000",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "8.html#gráfico-de-objeto-geodata",
    "href": "8.html#gráfico-de-objeto-geodata",
    "title": "Geoestadística Univariada con geoR",
    "section": "Gráfico de objeto geodata",
    "text": "Gráfico de objeto geodata\n\nDocumentación plotgeodata\n\nGráfico del objeto geodata\n\nplot(aquiferg, qt.col = c(\"purple\",\n                         \"pink\",\n                         \"green\",\n                         \"yellow\"))\n\n\n\n\n\n\n\n\nGráfico con el parametro 3d\n\nplot(aquiferg, scatter3d = T)\n\n\n\n\n\n\n\n\nGráfico removiendo la tendencia (trend )\n\nplot(aquiferg, trend = \"1st\")",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "8.html#gráficos-descriptivos-interpolación",
    "href": "8.html#gráficos-descriptivos-interpolación",
    "title": "Geoestadística Univariada con geoR",
    "section": "Gráficos descriptivos interpolación",
    "text": "Gráficos descriptivos interpolación\n\nDocumentración Interpolación inderp\nDocumentación persp\nDocumentación drape.plot\n\n\npar(mfrow = c(2, 2),\n    mar = c(3, 3, 1, 1),\n    mgp = c(2, 1, 0))\n# Esta función agrupa los siguientes gráficos en\n# una matrix 2x2\n\ngrillas &lt;- interp(aquifer$Este,\n                  aquifer$Norte,\n                  aquifer$Profundidad)\n\npersp(grillas$x,\n      grillas$y,\n      grillas$z,\n      xlab = \"Este\",\n      ylab = \"Norte\",\n      zlab = \"Nivel freatico\",\n      phi = 30,\n      theta = 20,\n      col = \"lightblue\",\n      expand = .5,\n      ticktype = \"detailed\")\n\ndrape.plot(grillas$x,\n           grillas$y,\n           grillas$z,\n           xlab = \"Este\",\n           ylab = \"Norte\",\n           zlab = \"z\",\n           theta = 45,\n           col = topo.colors(64),\n           expand = .5,\n           ticktype = \"detailed\")\n\n\ndrape.plot(grillas$x,\n           grillas$y,\n           grillas$z,\n           xlab = \"Este\",\n           ylab = \"Norte\",\n           zlab = \"z\",\n           theta = -10,\n           col = topo.colors(64),\n           expand = .5,\n           ticktype = \"detailed\")\n\n\ndrape.plot(grillas$x,\n           grillas$y,\n           grillas$z,\n           xlab = \"Este\",\n           ylab = \"Norte\",\n           zlab = \"z\",\n           theta = 60,\n           col = topo.colors(64),\n           expand = .5,\n           ticktype = \"detailed\")",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "8.html#gráficos-de-contorno",
    "href": "8.html#gráficos-de-contorno",
    "title": "Geoestadística Univariada con geoR",
    "section": "Gráficos de contorno",
    "text": "Gráficos de contorno\n\nDocumentación contour\nDocumentación filled.contour",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Geoestadística Univariada con GeoR </span>"
    ]
  },
  {
    "objectID": "9.html",
    "href": "9.html",
    "title": "Kriging",
    "section": "",
    "text": "Kriging",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Geoestadística </span>",
      "<span style='color: #728387 !important;'>Kriging</span>"
    ]
  },
  {
    "objectID": "10.html",
    "href": "10.html",
    "title": "Implementación de los modelos",
    "section": "",
    "text": "Implementación de los modelos",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Modelos de Regresión Espacial</span>",
      "<span style='color: #728387 !important;'>Implementación de los Modelos </span>"
    ]
  },
  {
    "objectID": "1.html",
    "href": "1.html",
    "title": "Definición",
    "section": "",
    "text": "Estadística Espacial Funcional",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Estadística Espacial Funcional  </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "1.html#definición",
    "href": "1.html#definición",
    "title": "Definición",
    "section": "Definición",
    "text": "Definición\nLa geoestadística funcional es una extensión del marco teórico de la geoestadística tradicional, que permite el análisis y modelado de datos funcionales correlacionados espacialmente, tanto univariados como multivariados. Este enfoque incluye herramientas exploratorias, predicción espacial mediante kriging y cokriging, muestreo óptimo, clasificación supervisada y simulación. A través de este enfoque, se modela la estructura de dependencia espacial entre curvas, lo que permite realizar predicciones en ubicaciones no muestreadas utilizando predictores funcionales que minimizan las varianzas del error de predicción. Además, se ofrece la optimización de la configuración de las ubicaciones de muestreo para mejorar la predicción espacial funcional.\nLas herramientas disponibles también permiten la representación gráfica de las curvas predichas en cada ubicación y el mapeo de las superficies en cada punto temporal. La clasificación supervisada integra la correlación espacial, y se extiende a escenarios con medidas funcionales repetidas en cada localización. Finalmente, la simulación de datos funcionales correlacionados espacialmente puede ser tanto condicional como incondicional, y se fundamenta en el supuesto de espacios de Hilbert conjuntos gaussianos.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Estadística Espacial Funcional  </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "1.html#datos-funcionales",
    "href": "1.html#datos-funcionales",
    "title": "Definición",
    "section": "Datos Funcionales",
    "text": "Datos Funcionales\nImaginemos que estamos interesados en estudiar cómo varía la temperatura en diferentes ciudades del mundo durante un año completo. Para hacerlo, en lugar de tomar una sola medida de la temperatura, registramos el promedio mensual de la termperatura durante todo un año.\nEn lugar de analizar cada punto de temperatura de manera independiente, podemos ver la temperatura a lo largo del añi como una función continua del tiempo. Esta función nos describe cómo la temperatura cambia en cada instante del día, lo cual permite realizar análisis mucho más precisos.\n\n\n\n\nPZmaps, CC BY-SA 3.0, via Wikimedia Commons\n\n\n\nLos datos funcionales son los que en lugar de contemplar cada dato como una observación puntual, se consideran como funciones continuas observadas en un conjunto de puntos. Los datos funcionales permiten capturar mejor la complejidad de fenómenos que además de variar en el espacio, varían en dominios continuos como el tiempo o la altitud, además de facilitar la detección de tendencias o anomalías teniendo en cuenta múltiples dimensiones de variación.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Estadística Espacial Funcional  </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Paquete",
    "section": "",
    "text": "Paquete\nSpatFD es un paquete en R diseñado para facilitar el análisis de datos espaciales con componentes funcionales. Proporciona herramientas para manejar datos funcionales espaciales, permitiendo a investigadores y analistas explorar, modelar y visualizar de manera eficiente la variabilidad y dependencias espaciales en conjuntos de datos complejos.\nNuestro paquete está pensado para soportar una amplia gama de aplicaciones, desde estudios ambientales hasta econometría, ofreciendo métodos adaptables a diversos dominios. Ya sea que estés trabajando con tendencias geoespaciales, dinámicas temporales o relaciones funcionales, SpatFD te brinda la flexibilidad y las herramientas necesarias para extraer conclusiones significativas.\nSpatFD ha sido desarrollado con un enfoque en la usabilidad y el rendimiento, asegurando que tanto usuarios novatos como experimentados de R puedan aprovechar sus capacidades para realizar investigaciones avanzadas en estadística espacial. Únete a nuestra creciente comunidad de usuarios y explora el potencial de los datos funcionales espaciales con SpatFD.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Estadística Espacial Funcional  </span>",
      "<span style='color: #728387 !important;'>Paquete </span>"
    ]
  },
  {
    "objectID": "intro.html#referencias",
    "href": "intro.html#referencias",
    "title": "Paquete",
    "section": "Referencias",
    "text": "Referencias\n\nBohorquez, M., Giraldo, R., & Mateu, J. (2016). Optimal sampling for spatial prediction of functional data. Statistical Methods & Applications, 25(1), 39-54.\nBohorquez, M., Giraldo, R., & Mateu, J. (2016). Multivariate functional random fields: prediction and optimal sampling. Stochastic Environmental Research and Risk Assessment, 31, pages53–70 (2017).\nBohorquez M., Giraldo R. and Mateu J. (2021). Spatial prediction and optimal sampling of functional data in Geostatistical Functional Data Analysis: Theory and Methods. John Wiley Sons, Chichester, UK. ISBN: 978-1-119-38784-8. https://www.wiley.com/en-us/Geostatistical+Functional+Data+Analysis-p-9781119387848.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Estadística Espacial Funcional  </span>",
      "<span style='color: #728387 !important;'>Paquete </span>"
    ]
  },
  {
    "objectID": "4.html",
    "href": "4.html",
    "title": "AirQualityBogota",
    "section": "",
    "text": "AirQualityBogota",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>AirQualityBogota</span>"
    ]
  },
  {
    "objectID": "4.html#descripción",
    "href": "4.html#descripción",
    "title": "AirQualityBogota",
    "section": "Descripción",
    "text": "Descripción\nEl conjunto de datos AirQualityBogota contiene información sobre la calidad del aire en Bogotá, Colombia. Específicamente, incluye mediciones de material particulado 10 (PM10) recolectadas en 10 estaciones de monitoreo distribuidas por la ciudad. Al cargar los datos encontrará en el ambiente\n\ncoord: Un DataFrame con los nombres y coordenadas de cada una de las estaciones de monitoreo.\nmap: Un objeto del tipo sf que contiene el mapa de Bogotá.\nPM10: Contiene las observaciones de PM10 de cada estación.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>AirQualityBogota</span>"
    ]
  },
  {
    "objectID": "4.html#qué-es-el-pm10",
    "href": "4.html#qué-es-el-pm10",
    "title": "AirQualityBogota",
    "section": "¿Qué es el PM10?",
    "text": "¿Qué es el PM10?\nEl PM10 se refiere a partículas de materia en el aire con un diámetro de 10 micrómetros o menos. Estas partículas son lo suficientemente pequeñas como para ser inhaladas y pueden tener efectos negativos en la salud humana, especialmente en los sistemas respiratorio y cardiovascular.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>AirQualityBogota</span>"
    ]
  },
  {
    "objectID": "4.html#uso",
    "href": "4.html#uso",
    "title": "AirQualityBogota",
    "section": "Uso",
    "text": "Uso\nPara cargar los datos en R, usa el siguiente comando:\n\nlibrary(sf)\n\nWarning: package 'sf' was built under R version 4.4.3\n\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(SpatFD)\n\nWarning: package 'SpatFD' was built under R version 4.4.3\n\ndata(AirQualityBogota)\n\n\nstr(coord)\n\n'data.frame':   10 obs. of  3 variables:\n $ ESTACION: chr  \"Bsq\" \"IDRD\" \"Sony\" \"EscIng\" ...\n $ X       : num  105076 99661 92104 103675 98239 ...\n $ Y       : num  112526 106572 99968 120780 118365 ...\n\n\n\nstr(PM10)\n\n'data.frame':   8761 obs. of  10 variables:\n $ Bosque       : int  29 32 32 24 29 31 24 26 25 36 ...\n $ IDRD         : int  53 48 25 36 17 7 9 12 12 13 ...\n $ Carvajal_Sony: int  72 69 61 30 42 44 30 39 53 49 ...\n $ Guaymaral    : int  74 55 58 51 41 39 46 60 54 41 ...\n $ Suba_Corpas  : int  53 52 45 45 38 40 44 67 51 41 ...\n $ Fontibon     : int  65 49 35 40 26 23 21 29 32 30 ...\n $ PteAranda    : int  91 70 45 43 33 11 15 28 24 31 ...\n $ MAVDT        : int  31 32 32 29 21 21 25 29 26 32 ...\n $ Kennedy      : int  135 94 68 53 47 45 49 59 62 71 ...\n $ Tunal        : int  38 29 18 17 24 24 19 15 20 35 ...\n\n\n\nplot(map$geometry)",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>AirQualityBogota</span>"
    ]
  },
  {
    "objectID": "5.html",
    "href": "5.html",
    "title": "Vowels",
    "section": "",
    "text": "Vowels",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>Vowels</span>"
    ]
  },
  {
    "objectID": "5.html#descripción",
    "href": "5.html#descripción",
    "title": "Vowels",
    "section": "Descripción",
    "text": "Descripción\nEl conjunto de datos vowels contiene señales de electroencefalograma (EEG) tomadas de 21 electrodos, durante la actividad mental de imaginar las cinco vocales del idioma español. Este conjunto de datos se desarrolló para ser aplicado en una interfaz cerebro-computadora (BCI, por sus siglas en inglés) destinada al control de una prótesis de mano.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>Vowels</span>"
    ]
  },
  {
    "objectID": "5.html#qué-es-una-interfaz-cerebro-computadora-bci",
    "href": "5.html#qué-es-una-interfaz-cerebro-computadora-bci",
    "title": "Vowels",
    "section": "¿Qué es una interfaz cerebro-computadora (BCI)?",
    "text": "¿Qué es una interfaz cerebro-computadora (BCI)?\nUna BCI permite a las personas controlar dispositivos externos, como prótesis, usando únicamente señales cerebrales. En este caso, el conjunto de datos recoge la actividad cerebral relacionada con el pensamiento imaginario de las vocales, lo que se espera que ayude a entrenar modelos para la clasificación y control de una prótesis.\n\n\n\nBrain BCI, Adindva1, CC BY-SA 4.0",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>Vowels</span>"
    ]
  },
  {
    "objectID": "5.html#uso",
    "href": "5.html#uso",
    "title": "Vowels",
    "section": "USO",
    "text": "USO\nPara cargar los datos en R, usa el siguiente comando:\n\ndata(\"vowels\")\n\nWarning in data(\"vowels\"): data set 'vowels' not found",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>Vowels</span>"
    ]
  },
  {
    "objectID": "6.html",
    "href": "6.html",
    "title": "Mex PM10",
    "section": "",
    "text": "Mex PM10",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>CokMexico</span>"
    ]
  },
  {
    "objectID": "6.html#descripción",
    "href": "6.html#descripción",
    "title": "Mex PM10",
    "section": "Descripción",
    "text": "Descripción\nEl conjunto de datos COKMexico contiene información sobre la calidad del aire en 13 ubicaciones de México. Específicamente, incluye mediciones de material particulado 10 (PM10) y N02 recolectadas en 13 estaciones de monitoreo distribuidas por el país. Al cargar los datos encontrará en el ambiente.\n\ncoord_NO2: Un DataFrame con las coordenadas de cada una de las estaciones de monitoreo donde se midió el NO2.\ncoord_PM10 Un DataFrame con las coordenadas de cada una de las estaciones de monitoreo donde se midió el PM10.\nmap_mex: Un objeto del tipo sf que contiene el mapa de Bogotá.\nMex_PM10: Contiene las observaciones de PM10 de cada estación.\nNO2: Contiene las observaciones de NO2 de cada estación.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>CokMexico</span>"
    ]
  },
  {
    "objectID": "6.html#qué-es-el-pm10",
    "href": "6.html#qué-es-el-pm10",
    "title": "Mex PM10",
    "section": "¿Qué es el PM10?",
    "text": "¿Qué es el PM10?\nEl PM10 se refiere a partículas de materia en el aire con un diámetro de 10 micrómetros o menos. Estas partículas son lo suficientemente pequeñas como para ser inhaladas y pueden tener efectos negativos en la salud humana, especialmente en los sistemas respiratorio y cardiovascular.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>CokMexico</span>"
    ]
  },
  {
    "objectID": "6.html#qué-es-el-no2",
    "href": "6.html#qué-es-el-no2",
    "title": "Mex PM10",
    "section": "¿Qué es el NO2?",
    "text": "¿Qué es el NO2?\nEl dióxido de nitrógeno NO2 es un contaminante del aire que se forma como subproducto en los procesos de combustión a altas temperaturas. Suele ser un contaminante común sobretodo en zonas urbanas.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>CokMexico</span>"
    ]
  },
  {
    "objectID": "6.html#uso",
    "href": "6.html#uso",
    "title": "Mex PM10",
    "section": "Uso",
    "text": "Uso\nPara cargar los datos en R, usa el siguiente comando:\n\nLinking to GEOS 3.12.2, GDAL 3.9.3, PROJ 9.4.1; sf_use_s2() is TRUE\n\n\nlibrary(sf)\n\nWarning: package 'sf' was built under R version 4.4.3\n\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(SpatFD)\n\nWarning: package 'SpatFD' was built under R version 4.4.3\n\n\n\ndata(\"COKMexico\")\n\n\nstr(coord_NO2)\n\n'data.frame':   18 obs. of  2 variables:\n $ X: num  509226 473346 482180 469366 479189 ...\n $ Y: num  2171149 2164689 2152665 2141275 2180751 ...\n\n\n\nstr(coord_PM10)\n\n'data.frame':   13 obs. of  2 variables:\n $ X: num  509226 479189 474444 484020 487445 ...\n $ Y: num  2171149 2180751 2154232 2146380 2147815 ...\n\n\n\nstr(Mex_PM10)\n\n int [1:4344, 1:13] 84 110 140 131 151 181 147 139 118 74 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:4344] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ : chr [1:13] \"ACO\" \"CUT\" \"FAC\" \"HGM\" ...\n\n\n\nstr(Mex_PM10)\n\n int [1:4344, 1:13] 84 110 140 131 151 181 147 139 118 74 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:4344] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ : chr [1:13] \"ACO\" \"CUT\" \"FAC\" \"HGM\" ...\n\n\n\nstr(NO2)\n\n int [1:4292, 1:18] 21 21 21 18 16 12 12 10 9 10 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:4292] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ : chr [1:18] \"ACO\" \"ATI\" \"CAM\" \"CUA\" ...\n\n\n\nplot(map_mex)",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Datasets </span>",
      "<span style='color: #728387 !important;'>CokMexico</span>"
    ]
  },
  {
    "objectID": "2.html",
    "href": "2.html",
    "title": "Definición",
    "section": "",
    "text": "Kriging",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#definición",
    "href": "2.html#definición",
    "title": "Definición",
    "section": "Definición",
    "text": "Definición\nEl Kriging es un método de interpolación basado en la teoría de procesos estocástocos que permite estimar los valores que toma una variable en lugares no muestreados a partir de la suposición de que las ubicaciones están correlacionadas espacialmente.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#kriging-ordinario",
    "href": "2.html#kriging-ordinario",
    "title": "Definición",
    "section": "Kriging Ordinario",
    "text": "Kriging Ordinario\nDado un conjunto de observaciones en diferentes localizaciones \\(s_1, s_2, ...,s_n\\) busca predecir el valor de la variable de interés en una nueva ubicación \\(s_0\\) como una combinación ponderada de las observaciones:\n\\[\n\\hat{Z}(s_0) = \\sum_{i=1}^{n} \\lambda_i Z(s_i)\n\\]\nDonde \\(\\lambda_i\\) son los pesos asignados a cada observación, determinados en función de la covarianza espacial entre \\(s_0\\) y \\(s_i\\) determinado por un variograma.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#kriging-funcional",
    "href": "2.html#kriging-funcional",
    "title": "Definición",
    "section": "Kriging Funcional",
    "text": "Kriging Funcional\nEn el contexto funcional, las observaciones en cada ubicación espacial no son valores discretos sino funciones completas. Supongamos que tenemos un conjunto de funciones \\(X(s_1, t), X(s_2, t), \\cdots, X(s_n, t)\\) donde cada \\(X(s_i, t)\\) es una función que describe el comportamiento de la variable de interés a lo largo de un dominio continuo \\(t\\) (como el tiempo).\nEl kriging funcional extiende la idea del kriging clásico al predecir una función en una nueva ubicación \\(s_0\\) utilizando una combinación ponderada de las funciones observadas en las localizaciones \\(s_1, \\cdots, s_n\\). En ese orden de ideas, podemos formular el kriging funcional de la siguiente manera:\n\\[\\hat{X}(s_0, t) = \\sum_{i=1}^{n} \\lambda_i(t) X(s_i, t)\\] Donde \\(\\lambda_i\\) son las funciones de peso que dependen de la localización y del dominio funcional \\(t\\). Estas funciones de peso se determinan resolviendo un sistema de ecuaciones basado en la covariancia entre las funciones observadas y la función a predecir.\nCon el paquete SpatFD podemos crear un objeto SpatFD y definir los modelos de semivariogramas que vamos a emplear en el kriging. En este caso usaremos los datos AirQualityBogota y ajustaremos tres semivariogramas, uno wave, uno Mattern y por último un exponencial, la ubicación que queremos predecir se define en la variable newcoorden.\n\nlibrary(SpatFD)\nlibrary(gstat)\n\ndata(AirQualityBogota)\n\n#s_0 nonsampled location. It could be data.frame or matrix and one or more locations of interest\nnewcoorden &lt;- data.frame(\n              X = seq(93000, 105000, length.out = 100),\n              Y = seq(97000, 112000, length.out = 100))\n\n# Building the SpatFD object\n\ncoords_muestras &lt;- coord[, -1]  \n\nSFD_PM10 &lt;- SpatFD(\n  PM10,                     \n  coords = coords_muestras, \n  basis = \"Bsplines\",\n  nbasis = 17,\n  norder = 5,\n  lambda = 0.00002,\n  nharm = 3\n)\n\n# Semivariogram models for each spatial random field of scores\nmodelos &lt;- list(  vgm(psill = 2199288.58, model = \"Sph\", range = 1484.57, nugget = 0),\n                  vgm(psill = 62640.74, model = \"Mat\", range = 1979.43, nugget = 0, kappa = 0.68),\n                  vgm(psill = 37098.25, model = \"Exp\", range = 6433.16, nugget = 0))\n\nExisten dos enfoques diferentes para realizar el kriging funcional, el método de scores y el método lambda.",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#método-de-scores",
    "href": "2.html#método-de-scores",
    "title": "Definición",
    "section": "Método de Scores",
    "text": "Método de Scores\nEn el método de scores, el análisis funcional se basa en una descomposición de las funciones observadas en un conjunto de componentes principales, generalmente a través de una descomposición en funciones base (como la descomposición en funciones ortogonales o en series de Fourier). Este método se descompone en dos etapas:\n\nDescomposición funcional: Se aplica una descomposición funcional de las observaciones para representar cada función como una combinación de componentes principales (bases funcionales) y sus correspondientes coeficientes o “scores”. Si las funciones \\(X(s_i,t)\\) observadas se pueden representar como:\n\\[\nX(s_{i}, t) = \\sum_{k=1}^{K} \\alpha_{ik}\\phi_{k}(t)\n\\]\ndonde \\(\\phi_{k}(t)\\) son las bases funcionales y \\(\\alpha_{ik}\\) son los scores de las componentes principales para cada localización \\(s_{i}\\). En lugar de predecir la función completa, este método se centra en predecir los scores en la ubicación no observada \\(s_{0}\\).\nPredicción de una nueva ubicación: El kriging se aplica sobre los scores obtenidos. Se predicen los scores de la nueva ubicación \\(s_{0}\\) para construir la función predicha \\(\\hat{X}(s_{0}, t)\\) como una combinación de las bases funcionales ponderadas por los scores predichos:\n\\[\\hat{X}(s_{0}, t) = \\sum_{k=1}^{K} \\alpha_{0k}\\phi_{k}(t)\\]\nLa función KS_scores_lambdas permite realizar el kriging usando este método al usar ``scores’’ en la opción method.\n\nKS_SFD_PM10_sc &lt;- KS_scores_lambdas(SFD_PM10, newcoorden, method = \"scores\", model = modelos)\n\nUsing first variable by default\n\n\nUsing fill.all = TRUE by default\n\n\n[using simple kriging]\n[using simple kriging]\n[using simple kriging]",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#método-lambda",
    "href": "2.html#método-lambda",
    "title": "Definición",
    "section": "Método Lambda",
    "text": "Método Lambda\nEste método utiliza una combinación de las funciones observadas, ponderadas por ciertos coeficientes o pesos, para estimar la función en la nueva ubicación, es decir, el kriging se lleva a cabo directamente sobre las funciones. El predictor \\(\\check{\\chi}_{s_{0}}(t)\\) está dado por:\n\\[\\check{\\chi}_{s_{0}}(t) = \\sum_{i=1}^{n} \\lambda_{i}\\chi_{s_{i}}(t)\\]\nDeben encontrarse los pesos \\(\\lambda_{i}\\) que minimicen la diferencia entre la verdadera función en la ubicación no observada \\(s_{0}\\) y el predictor. Eso se expresa matemáticamente como:\n\\[min\\|\\chi_{s_{0}}(t) - \\check{\\chi}_{s_{0}}(t)\\|^2\\]\ndonde \\(\\chi_{s_{0}}(t)\\) es la verdadera función en la ubicación \\(s_{0}\\). La minimización de esta expresión se realiza en el sentido de la norma \\(L^{2}\\).\nLa función KS_scores_lambdas permite realizar el kriging usando este método al usar ‘’lambda’’ en la opción method.\n\nKS_SFD_PM10_both &lt;- KS_scores_lambdas(SFD_PM10, newcoorden, method = \"both\", model = modelos)\n\nUsing first variable by default\n\n\nUsing fill.all = TRUE by default\n\n\n[using simple kriging]\n[using simple kriging]\n[using simple kriging]",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "2.html#gráficamente",
    "href": "2.html#gráficamente",
    "title": "Definición",
    "section": "Gráficamente",
    "text": "Gráficamente\nPodemos graficar las predicciones usando la función ggplot_KS\n\nggplot_KS(KS_SFD_PM10_both,show.varpred = FALSE,\n         main = \"Plot 1 - Using Scores\",\n          main2 = \"Plot 2 - Using Lambda\",\n           ylab = \"PM10\")\n\n[[1]]\n\n\n\n\n\n\n\n\n\n\n[[2]]\n\n\n\n\n\n\n\n\n\nAsí mismo, podemos graficar las predicciones suavizadas en tiempos específicos.\n\np&lt;-ggmap_KS(KS_SFD_PM10_both,\n         map_path = map,\n         window_time = c(2108),\n         method = \"lambda\",\n         zmin = 50)\n\nUsing fill.all = TRUE by default\n\nprint(p)\n\n[[1]]",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Definición</span>"
    ]
  },
  {
    "objectID": "3.html",
    "href": "3.html",
    "title": "Definición",
    "section": "",
    "text": "Cokriging",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Cokriging</span>"
    ]
  },
  {
    "objectID": "3.html#definición",
    "href": "3.html#definición",
    "title": "Definición",
    "section": "Definición",
    "text": "Definición\nEl cokriging es una extensión del kriging que permite predecir una variable en una ubicación no muestreada utilizando no solo datos de esa misma variable, sino también información de otras variables relacionadas o covariables. Este método aprovecha la correlación espacial entre varias variables para mejorar la precisión de las predicciones.\n\nEjemplo\nSupongamos que queremos hacer la predicción tomando en cuenta \\(p\\) variables de forma simultánea. Considerando \\(Z(s_i) = (Z_1(s_i), Z_2(s_i), \\dots, Z_p(s_i))'\\), el predictor para \\(Z_l(s_0), 1 \\le l \\le p\\) basado en \\(p\\), basado en las \\(p\\) variables tiene la forma:\n\\[Z_l^*(s_0) = \\sum_{i=1}^{n} \\sum_{q=1}^{p} \\lambda_{qi} Z_q(s_i)\\]\nEl mejor predictor lineal insesgado de una variable en la ubicación \\(s_0\\) está dado por la minimización de\n\\[max_{1 \\le l \\le n} \\{Var[Z_l(s_0) - Z_l^*(s_0)]\\}\\]\nPor eficiencia computacional, puede decidirse minimizar\n\\[\\sum_{i=1}^{n} Var[Z_l(s_0) - Z_l^*(s_0)]\\]\nEn el paquete SpatFD se realiza cokriging sobre los scores elegidos para todas las variables funcionales involucradas. Las predicciones de scores se utilizan para construir el predictor funcional del cokriging.\n\nlibrary(SpatFD)\n\ndata(COKMexico)\n# Definimos nuestro objeto SpatFD\nSFD_PM10_NO2 &lt;- SpatFD(Mex_PM10, coords = coord_PM10, basis = \"Fourier\", \nnbasis = 21, lambda = 0.000001, nharm = 2)\n# Agregamos las observaciones de NO2 al objeto que creamos antes por medio del argumento add\nSFD_PM10_NO2 &lt;- SpatFD(NO2, coords = coord_NO2, basis = \"Fourier\", \nnbasis = 27, lambda = 0.000001, nharm = 2,\n                      add = SFD_PM10_NO2)\n# Definimos los modelos de varianza de cada una de las variables\nmodel1 &lt;- gstat::vgm(647677.1,\"Gau\",23317.05)\nmodel1 &lt;- gstat::vgm(127633,\"Wav\",9408.63, add.to = model1)\n\n# Especificamos la ubicación no muestreada\nnewcoords &lt;- data.frame(x = 509926, y = 2179149)\n\nLa función COKS_scores_lambdas nos permite hacer el cokriging funcional\n\ncokrig = COKS_scores_lambdas(SFD_PM10_NO2, newcoords, model1)\n\nUsing fill.all = TRUE by default\n\n\nUsing method = 'lambda' by default\n\n\n\n\n\n\n\n\n\nLinear Model of Coregionalization found. Good.\n[using ordinary cokriging]\n\n\n\ncokrig$modelfit\n\ndata:\nPC1.1 : formula = puntajes[[1]][[1]]`~`1 ; data dim = 13 x 2\nPC2.1 : formula = puntajes[[1]][[2]]`~`1 ; data dim = 13 x 2\nPC1.2 : formula = puntajes[[2]][[1]]`~`1 ; data dim = 18 x 2\nPC2.2 : formula = puntajes[[2]][[2]]`~`1 ; data dim = 18 x 2\nvariograms:\n               model      psill    range\nPC1.1[1]         Gau 356886.232 23317.05\nPC1.1[2]         Wav 251618.187  9408.63\nPC2.1[1]         Gau 157275.294 23317.05\nPC2.1[2]         Wav  66770.748  9408.63\nPC1.2[1]         Gau 509628.594 23317.05\nPC1.2[2]         Wav  86045.557  9408.63\nPC2.2[1]         Gau   9178.223 23317.05\nPC2.2[2]         Wav  77729.767  9408.63\nPC1.1.PC2.1[1]   Gau  96771.742 23317.05\nPC1.1.PC2.1[2]   Wav -11290.879  9408.63\nPC1.1.PC1.2[1]   Gau 358697.498 23317.05\nPC1.1.PC1.2[2]   Wav  84592.302  9408.63\nPC2.1.PC1.2[1]   Gau -36478.239 23317.05\nPC2.1.PC1.2[2]   Wav  57029.144  9408.63\nPC1.1.PC2.2[1]   Gau  11668.546 23317.05\nPC1.1.PC2.2[2]   Wav 137897.759  9408.63\nPC2.1.PC2.2[1]   Gau  -1677.278 23317.05\nPC2.1.PC2.2[2]   Wav -12680.551  9408.63\nPC1.2.PC2.2[1]   Gau  16583.870 23317.05\nPC1.2.PC2.2[2]   Wav  40857.282  9408.63",
    "crumbs": [
      "<span style='color: #FF8000 !important;'>Kriging </span>",
      "<span style='color: #728387 !important;'>Cokriging</span>"
    ]
  }
]